
lidong@x220:/data/source/Ares/leiot/output$ bin/mqtt_rrpc-example 
[dbg] IOT_SetupConnInfo(73): SDK Build Version : 1.0.0
[dbg] IOT_SetupConnInfo(74): SDK Build Datetime: 20180224212043
[inf] iotx_device_info_init(41): device_info created successfully!
[dbg] iotx_device_info_set(51): start to set device info!
[dbg] iotx_device_info_set(65): device_info set successfully!
[dbg] _calc_hmac_signature(57): | source: clientId9RrZXcGctqe.air-1deviceNameair-1productKey9RrZXcGctqetimestamp2524608000000 (83)
[dbg] _calc_hmac_signature(58): | secret: h9JVOI27YjzvJwhNjKzbzXwuuHQdLFtE (32)
[dbg] _calc_hmac_signature(61): | method: hmacsha1
[dbg] _calc_hmac_signature(74): | signature: 470185101986f1e922d95640f9f4671763d12ce1 (40)
[dbg] guider_print_dev_guider_info(236): ....................................................
[dbg] guider_print_dev_guider_info(237):           ProductKey : 9RrZXcGctqe
[dbg] guider_print_dev_guider_info(238):           DeviceName : air-1
[dbg] guider_print_dev_guider_info(239):             DeviceID : 9RrZXcGctqe.air-1
[dbg] guider_print_dev_guider_info(240):         DeviceSecret : h9JVOI27YjzvJwhNjKzbzXwuuHQdLFtE
[dbg] guider_print_dev_guider_info(241): ....................................................
[dbg] guider_print_dev_guider_info(242):        PartnerID Buf : ,partner_id=example.demo.partner-id
[dbg] guider_print_dev_guider_info(243):         ModuleID Buf : ,module_id=example.demo.module-id
[dbg] guider_print_dev_guider_info(244):           Guider URL : 
[dbg] guider_print_dev_guider_info(246):       Guider SecMode : 2 (TLS + Direct)
[dbg] guider_print_dev_guider_info(248):     Guider Timestamp : 2524608000000
[dbg] guider_print_dev_guider_info(249): ....................................................
[dbg] guider_print_dev_guider_info(250):          Guider Sign : 470185101986f1e922d95640f9f4671763d12ce1
[dbg] guider_print_dev_guider_info(255): ....................................................
[dbg] guider_print_conn_info(213): -----------------------------------------
[dbg] guider_print_conn_info(214):             Host : 9RrZXcGctqe.iot-as-mqtt.cn-shanghai.aliyuncs.com
[dbg] guider_print_conn_info(215):             Port : 1883
[dbg] guider_print_conn_info(216):         UserName : air-1&9RrZXcGctqe
[dbg] guider_print_conn_info(217):         PassWord : 470185101986f1e922d95640f9f4671763d12ce1
[dbg] guider_print_conn_info(218):         ClientID : 9RrZXcGctqe.air-1|securemode=2,timestamp=2524608000000,signmethod=hmacsha1,gw=0,partner_id=example.demo.partner-id,module_id=example.demo.module-id|
[dbg] guider_print_conn_info(220):       TLS PubKey : 0x486440 ('-----BEGIN CERTI ...')
[dbg] guider_print_conn_info(223): -----------------------------------------
[inf] iotx_mc_init(1709): MQTT init success!
[inf] _ssl_client_init(176): Loading the CA root certificate ...
cert. version     : 3
serial number     : 04:00:00:00:00:01:15:4B:5A:C3:94
issuer name       : C=BE, O=GlobalSign nv-sa, OU=Root CA, CN=GlobalSign Root CA
subject name      : C=BE, O=GlobalSign nv-sa, OU=Root CA, CN=GlobalSign Root CA
issued  on        : 1998-09-01 12:00:00
expires on        : 2028-01-28 12:00:00
signed using      : RSA with SHA1
RSA key size      : 2048 bits
basic constraints : CA=true
key usage         : Key Cert Sign, CRL Sign
[inf] _ssl_parse_crt(144): crt content:451
[inf] _ssl_client_init(184):  ok (0 skipped)
[inf] _TLSConnectNetwork(346): Connecting to /9RrZXcGctqe.iot-as-mqtt.cn-shanghai.aliyuncs.com/1883...
[inf] mbedtls_net_connect_timeout(291): setsockopt SO_SNDTIMEO timeout: 10s
[inf] _TLSConnectNetwork(359):  ok
[inf] _TLSConnectNetwork(364):   . Setting up the SSL/TLS structure...
[inf] _TLSConnectNetwork(374):  ok
[inf] _TLSConnectNetwork(409): Performing the SSL/TLS handshake...
[inf] _TLSConnectNetwork(417):  ok
[inf] _TLSConnectNetwork(421):   . Verifying peer X.509 certificate..
[inf] _real_confirm(93): certificate verification result: 0x00
[dbg] iotx_mc_connect(2020): start MQTT connection with parameters: clientid=9RrZXcGctqe.air-1|securemode=2,timestamp=2524608000000,signmethod=hmacsha1,gw=0,partner_id=example.demo.partner-id,module_id=example.demo.module-id|, username=air-1&9RrZXcGctqe, password=470185101986f1e922d95640f9f4671763d12ce1
[inf] iotx_mc_connect(2040): mqtt connect success!
[dbg] iotx_mc_report_mid(2263): MID Report: started in MQTT
[dbg] iotx_mc_report_mid(2280): MID Report: json data = '{"id":"9RrZXcGctqe_air-1_mid","params":{"_sys_device_mid":"example.demo.module-id","_sys_device_pid":"example.demo.partner-id"}}'
[dbg] iotx_mc_report_mid(2296): MID Report: topic name = '/sys/9RrZXcGctqe/air-1/thing/status/update'
[dbg] MQTTPublish(236): leiot publish topic: /sys/9RrZXcGctqe/air-1/thing/status/update
[dbg] iotx_mc_report_mid(2313): MID Report: finished, IOT_MQTT_Publish() = 0
[dbg] MQTTSubscribe(361): leiot subscribe topic: /sys/9RrZXcGctqe/air-1/rrpc/request/+
[inf] iotx_mc_subscribe(1399): mqtt subscribe success,topic = /sys/9RrZXcGctqe/air-1/rrpc/request/+!
[dbg] iotx_mc_cycle(1280): SUBACK
subscribe success, packet-id=1
Waiting RRPC from Cloud ...
[dbg] iotx_mc_cycle(1288): PUBLISH
[dbg] iotx_mc_handle_recv_PUBLISH(1101):         Packet Ident : 00000000
[dbg] iotx_mc_handle_recv_PUBLISH(1102):         Topic Length : 54
[dbg] iotx_mc_handle_recv_PUBLISH(1106):           Topic Name : /sys/9RrZXcGctqe/air-1/rrpc/request/967391293124579328
[dbg] iotx_mc_handle_recv_PUBLISH(1109):     Payload Len/Room : 14 / 966
[dbg] iotx_mc_handle_recv_PUBLISH(1110):       Receive Buflen : 1024
[dbg] iotx_mc_handle_recv_PUBLISH(1121): delivering msg ...
[dbg] iotx_mc_deliver_message(876): topic be matched
----
Topic: '/sys/9RrZXcGctqe/air-1/rrpc/request/967391293124579328' (Length: 54)
Payload: '{aaaaa}{bbbbb}' (Length: 14)
----
response msg_id = 967391293124579328
response topic = /sys/9RrZXcGctqe/air-1/rrpc/response/967391293124579328
[dbg] MQTTPublish(236): leiot publish topic: /sys/9RrZXcGctqe/air-1/rrpc/response/967391293124579328
Waiting RRPC from Cloud ...
Waiting RRPC from Cloud ...
Waiting RRPC from Cloud ...
[dbg] iotx_mc_cycle(1288): PUBLISH
[dbg] iotx_mc_handle_recv_PUBLISH(1101):         Packet Ident : 00000000
[dbg] iotx_mc_handle_recv_PUBLISH(1102):         Topic Length : 54
[dbg] iotx_mc_handle_recv_PUBLISH(1106):           Topic Name : /sys/9RrZXcGctqe/air-1/rrpc/request/967391306238717952
[dbg] iotx_mc_handle_recv_PUBLISH(1109):     Payload Len/Room : 14 / 966
[dbg] iotx_mc_handle_recv_PUBLISH(1110):       Receive Buflen : 1024
[dbg] iotx_mc_handle_recv_PUBLISH(1121): delivering msg ...
[dbg] iotx_mc_deliver_message(876): topic be matched
----
Topic: '/sys/9RrZXcGctqe/air-1/rrpc/request/967391306238717952' (Length: 54)
Payload: '{aaaaa}{bbbbb}' (Length: 14)
----
response msg_id = 967391306238717952
response topic = /sys/9RrZXcGctqe/air-1/rrpc/response/967391306238717952
[dbg] MQTTPublish(236): leiot publish topic: /sys/9RrZXcGctqe/air-1/rrpc/response/967391306238717952
Waiting RRPC from Cloud ...
Waiting RRPC from Cloud ...
Waiting RRPC from Cloud ...
[dbg] iotx_mc_cycle(1288): PUBLISH
[dbg] iotx_mc_handle_recv_PUBLISH(1101):         Packet Ident : 00000000
[dbg] iotx_mc_handle_recv_PUBLISH(1102):         Topic Length : 54
[dbg] iotx_mc_handle_recv_PUBLISH(1106):           Topic Name : /sys/9RrZXcGctqe/air-1/rrpc/request/967391321247387648
[dbg] iotx_mc_handle_recv_PUBLISH(1109):     Payload Len/Room : 14 / 966
[dbg] iotx_mc_handle_recv_PUBLISH(1110):       Receive Buflen : 1024
[dbg] iotx_mc_handle_recv_PUBLISH(1121): delivering msg ...
[dbg] iotx_mc_deliver_message(876): topic be matched
----
Topic: '/sys/9RrZXcGctqe/air-1/rrpc/request/967391321247387648' (Length: 54)
Payload: '{aaaaa}{bbbbb}' (Length: 14)
----
response msg_id = 967391321247387648
response topic = /sys/9RrZXcGctqe/air-1/rrpc/response/967391321247387648
[dbg] MQTTPublish(236): leiot publish topic: /sys/9RrZXcGctqe/air-1/rrpc/response/967391321247387648
Waiting RRPC from Cloud ...
Waiting RRPC from Cloud ...
Waiting RRPC from Cloud ...
[dbg] iotx_mc_cycle(1288): PUBLISH
[dbg] iotx_mc_handle_recv_PUBLISH(1101):         Packet Ident : 00000000
[dbg] iotx_mc_handle_recv_PUBLISH(1102):         Topic Length : 54
[dbg] iotx_mc_handle_recv_PUBLISH(1106):           Topic Name : /sys/9RrZXcGctqe/air-1/rrpc/request/967391336323891200
[dbg] iotx_mc_handle_recv_PUBLISH(1109):     Payload Len/Room : 14 / 966
[dbg] iotx_mc_handle_recv_PUBLISH(1110):       Receive Buflen : 1024
[dbg] iotx_mc_handle_recv_PUBLISH(1121): delivering msg ...
[dbg] iotx_mc_deliver_message(876): topic be matched
----
Topic: '/sys/9RrZXcGctqe/air-1/rrpc/request/967391336323891200' (Length: 54)
Payload: '{aaaaa}{bbbbb}' (Length: 14)
----
response msg_id = 967391336323891200
response topic = /sys/9RrZXcGctqe/air-1/rrpc/response/967391336323891200
[dbg] MQTTPublish(236): leiot publish topic: /sys/9RrZXcGctqe/air-1/rrpc/response/967391336323891200
Waiting RRPC from Cloud ...
Waiting RRPC from Cloud ...
Waiting RRPC from Cloud ...
[dbg] iotx_mc_cycle(1288): PUBLISH
[dbg] iotx_mc_handle_recv_PUBLISH(1101):         Packet Ident : 00000000
[dbg] iotx_mc_handle_recv_PUBLISH(1102):         Topic Length : 54
[dbg] iotx_mc_handle_recv_PUBLISH(1106):           Topic Name : /sys/9RrZXcGctqe/air-1/rrpc/request/967391351497244672
[dbg] iotx_mc_handle_recv_PUBLISH(1109):     Payload Len/Room : 14 / 966
[dbg] iotx_mc_handle_recv_PUBLISH(1110):       Receive Buflen : 1024
[dbg] iotx_mc_handle_recv_PUBLISH(1121): delivering msg ...
[dbg] iotx_mc_deliver_message(876): topic be matched
----
Topic: '/sys/9RrZXcGctqe/air-1/rrpc/request/967391351497244672' (Length: 54)
Payload: '{aaaaa}{bbbbb}' (Length: 14)
----
response msg_id = 967391351497244672
response topic = /sys/9RrZXcGctqe/air-1/rrpc/response/967391351497244672
[dbg] MQTTPublish(236): leiot publish topic: /sys/9RrZXcGctqe/air-1/rrpc/response/967391351497244672
Waiting RRPC from Cloud ...


=============================================
Test.py 
rrpc success  b'{"MessageId":967391293124579328,"RequestId":"762C332B-0858-414C-B71E-BD7CA298F743","PayloadBase64Byte":"cnJwYyBjbGllbnQgaGFzIHJlY2VpdmVkIG1lc3NhZ2UhCg==","Success":true,"RrpcCode":"SUCCESS"}'
rrpc success  b'{"MessageId":967391306238717952,"RequestId":"55A6F616-14F1-492E-BAC7-E1C55C85D6A6","PayloadBase64Byte":"cnJwYyBjbGllbnQgaGFzIHJlY2VpdmVkIG1lc3NhZ2UhCg==","Success":true,"RrpcCode":"SUCCESS"}'
rrpc success  b'{"MessageId":967391321247387648,"RequestId":"E3D8CAD5-5B1D-4F12-BDF3-0CC5D5C36E6D","PayloadBase64Byte":"cnJwYyBjbGllbnQgaGFzIHJlY2VpdmVkIG1lc3NhZ2UhCg==","Success":true,"RrpcCode":"SUCCESS"}'
rrpc success  b'{"MessageId":967391336323891200,"RequestId":"E4EEAC83-93BB-43C7-BE66-E618A6726E0D","PayloadBase64Byte":"cnJwYyBjbGllbnQgaGFzIHJlY2VpdmVkIG1lc3NhZ2UhCg==","Success":true,"RrpcCode":"SUCCESS"}'
rrpc success  b'{"MessageId":967391351497244672,"RequestId":"5303E7B6-C14C-439D-93D1-63763409C365","PayloadBase64Byte":"cnJwYyBjbGllbnQgaGFzIHJlY2VpdmVkIG1lc3NhZ2UhCg==","Success":true,"RrpcCode":"SUCCESS"}'

